# 压缩,打包,镜像,cpio



## 压缩
gzip

压缩解压都会把原始文件删除,如果想保留原始文件,要使用-k参数

>  -c	将压缩过程输出到屏幕上，可以通过重定向处理
> -d	解压
> -k	保留原始文件
> -v	显示压缩过程
> -n	n为数字，设置压缩比，9最高，1最快,默认为6
> -l	列出压缩文件的相关信息

zcat/zmore/zless

打印压缩文件中的信息,和cat/more/less命令用法类似

zgrep

在压缩文件中搜索字符串,和grep命令用法类似



## tar打包

```shell
tar -czvf 包名.tar.gz 待打包文件
```

tar -czvf 包名.tar.gz 待打包文件

> z代表gzip打包
>
> j代表bzip2
>
> J代表xz
>
> 其他选项：
>
> -p	保留权限
>
> -P	保留绝对路径
>
> --exclude=文件	打包时不讲此文件打包
>
> -t	不解压查看包中内容,和cx选项冲突
>
> -x	解压缩,和ct选项冲突
>
> -C	指定目录,无论压缩还是解压,都能指定目录
>
> -v	压缩,解压时在终端打印信息



## 镜像的制作

```shell
mkisofs -r -v -o 镜像文件名.img 文件(目录)
```

此方法可以将文件全放到镜像名的一层目录中,如果想将多个文件分层打包则使用-graft-point选项设置镜像中不同文件夹名

```shell
mkisofs -r -v -o 镜像名.img -graft-point /镜像中的目录名=待写到镜像中的目录名 /镜像中的目录名=待写到镜像中的目录名
```

> -V	建立卷名,类似windows文件管理器中光碟名
>
> -m	排除文件,后面接的文件不加入到镜像中

镜像信息查看

```shell
isoinfo -d -i 镜像文件
```



## cpio

备份etc目录

```shell
cd /
find /etc | cpio -ocvB > 文件
```

还原

```shell
cpio -idvc < 文件
```

查看

```shell
cpio -ivct < 文件
```

> 备份会用到的选项:
>
> -o	將資料 copy 輸出到檔案或裝置上 
> -B	讓預設的 Blocks 可以增加至 5120 bytes ，預設是 512 bytes ！ 這樣的好處是可以讓大檔案的儲存速度加快(請參考 i-nodes 的觀念)
>
> 还原会用到的选项:
>
> -i	將資料自檔案或裝置 copy 出來系統當中 
>
> -d	自動建立目錄！使用 cpio 所備份的資料內容不見得會在同一層目錄中，因此我們必須要讓 cpio 在還原時可以建立新目錄，此時就得要 -d 選項的幫助！
>
> -u	自動的將較新的檔案覆蓋較舊的檔案！
>
> -t	需配合 -i 選項，可用在"察看"以 cpio 建立的檔案或裝置的內容
>
> 一些可共用的选项:
>
> -v	讓儲存的過程中檔案名稱可以在螢幕上顯示 
>
> -c	一種較新的 portable format 方式儲存













