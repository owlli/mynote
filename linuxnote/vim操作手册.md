# vim操作手册

20190302,今天查资料又了解了vim script,映射map和exec的资料,又是完全陌生的东西,以前还想把vim各个功能完全弄懂,现在发现vim实在太复杂了,只要会用就ok了吧.



## 工作模式

常用的有四种模式,不同的资料上不同的叫法,参考<鸟哥的linux私房菜>我把他们称为:普通模式、编辑模式和命令行模式,块选择模式

还有在vim普通模式下按q进入ex命令行模式(不会用)

## vim编辑文件原理推测

在vim编辑一个文件test时,fuser -uv test是查询不到结果的,但是可以用fuser -uv .test.swp查询到此vim进程

推测:

vim工作原理应该是将原文件test复制到.test.swp中编辑,当编辑完成后执行:wq时.test.swp该名test将原文件test覆盖



## 查看vim自带教程

```shell
vimtutor
```

中文版

```shell
vimtutor zh
```

在vim内部看帮助

`:help xxx`

> xxx是想查看帮补的内容,可以是vim中set后面的选项,也可以是指令,如果是指令的话可以是指令的全称也可以是简写,但是简写有可能会搜索不到想要的结果,比如help指令可以简写为h,执行`:h h`时,只能看到光标移动指令h的介绍,就算执行`:ts`查看所有搜索结果,也只能多看到光标移动到当前页面最上方的指令H的介绍

查看vim文档中代表按键的符号的说明

`:help keycodes`

查看vim用户手册目录

`:help usr_toc`

查看vim用户手册某一章的内容

`:help usr_xx`

>  (xx代表章节数)

查看vim文档中代表按键的符号的说明

`:help keycodes`

## 查看vim配置

```shell
:version
:ver
```



## vim中的变量和选项

vim中的变量可以用echo命令来查看,可以用let命令更改,比如

```shell
:echo $VIMRUNTIME
:let $VIMRUNTIME="/test"
```

vim中的选项可以用set来查看和更改,比如

```shell
:set rtp
:set +=~/.vim/bundle/Vundle.vim
```

这里的rtp是runtimepath的缩写

## 临时加载本地配置

```shell
:source 配置文件路径
```



## 常用快捷键

### 移动光标

| 快捷键            | 效果                                                         |
| ----------------- | ------------------------------------------------------------ |
| `j`或向下箭头键   | 光标向下移动一个字符,向下移动30行,可以使用"30j"或"30↓"的组合按键.下面h,k,l,e,E使用方法类似 |
| `h`或向左箭头键   | 光标向左移动一个字符                                         |
| `k`或向上箭头键   | 光标向上移动一个字符                                         |
| `l`或向右箭头键   | 光标向右移动一个字符                                         |
| `e`               | 向后移动一个单词的末尾(以字母和数字组成的词,以符号或空格分割,移动过程中会移动到符号处) |
| `E`               | 向后移动一个单词的末尾(以空格分隔的词)                       |
| `ge`              | 向前移动一个单词的末尾(以字母和数字组成的词,以符号或空格分割,移动过程中会移动到符号处) |
| `gE`              | 向前移动一个单词的末尾(以空格分隔的词)                       |
| `w`,`b`,`nw`,`nb` | 向后/前移动一/n个单词的开头(以字母和数字组成的词,以符号或空格分割,移动过程中会移动到符号处) |
| `W`,`B`,`nW`,`nB` | 向后/前移动一/n个单词的开头(以空格分隔的词)                  |
| [Ctrl]+[f]        | 屏幕『向下』移动一页,相当于[Page Down]按键                   |
| [Ctrl]+[b]        | 屏幕『向上』移动一页,相当于[Page Up]按键                     |
| [Ctrl]+[d]        | 屏幕『向下』移动半页                                         |
| [Ctrl]+[u]        | 屏幕『向上』移动半页                                         |
| [Ctrl]+[e]        | 屏幕向下移动一行                                             |
| [Ctrl]+[y]        | 屏幕向上移动一行                                             |
| [Ctrl]+[g]        | 显示文件名、文件总行数和当前光标行在文件中的所占的百分比     |
| `n+`              | 光标移动到下n行的首个非空格符,n默认为1                       |
| `n-`              | 光标移动到上n行的首个非空格符,n默认为1                       |
| `n_`              | 光标移动到下n-1行的首个非空格符,n默认为1,即移动到当前行的首个非空格符 |
| `n<space>`        | n表示『数字』,例如20.按下数字后再按空格键,光标会向右移动这一行的n个字符.例如`20<space>`则光标会向后面移动20个字符距离. |
| `0`或功能键[Home] | 这是数字『0』：移动到这一行的最前面字符处                    |
| `$`或功能键[End]  | 移动到这一行的最后面字符处                                   |
| `gm`              | 光标移动到本行中间                                           |
| `^`               | 光标移动到本行第一个不是空格,tab字符的位置                   |
| `g_`              | 光标移动到本行最后一个不是空格,tab字符的位置                 |
| `H`               | 光标移动到这个屏幕的最上方那一行的第一个字符                 |
| `M`               | 光标移动到这个屏幕的中央那一行的第一个字符                   |
| `L`               | 光标移动到这个屏幕的最下方那一行的第一个字符                 |
| `G`               | 移动到这个档案的最后一行                                     |
| `nG`              | n为数字.移动到这个档案的第n行.例如20G则会移动到这个档案的第20行(可配合:set nu) |
| `gg`              | 移动到这个档案的第一行,相当于1G                              |
| `n<Enter>`        | n为数字.光标向下移动n行                                      |
| `%`               | 光标在(,{,[符号上时跳到匹配的括号上,再次按%只能在这两个符号上移动 |
| `[[`              | 跳转到光标所在代码块的开头,如果光标已在代码块的开头,跳到上一段代码块的开头(要求代码块中'{'必须单独占一行) |
| `]]`              | 跳转到光标所在代码块的末尾,如果光标已在代码块的末尾,跳到下一段代码块的末尾(要求代码块中'{'必须单独占一行) |
| `(`               | 移动到句首(根据?.!空格回车符号),如果已经在句首,跳到上一句的句首,可以在前面加n代表跳n次 |
| `)`               | 移动到句尾(根据?.!空行回车符号),如果已经在句尾,跳到上一句的句尾,可以在前面加n代表跳n次 |
| `{`               | 移动到段首(根据空行),如果已经在段首,跳到上一段的段首,可以在前面加n代表跳n次 |
| `}`               | 移动到段尾(根据空行),如果已经在段尾,跳到上一段的段尾,可以在前面加n代表跳n次 |
| `z<Enter>`        | 使光标指向的当前行成为屏幕的首行                             |
| `z.`              | 使光标指向的当前行成为屏幕的中间行                           |
| `z-`              | 使光标指向的挡前行成为屏幕的尾行                             |

在括号内移动光标

| 快捷键 | 效果           |
| ------ | -------------- |
| `[{`   | 移动到{}的开始 |
| `]}`   | 移动到{}的末尾 |

> 如果在()中移动,把[]后面的{}换成()

在/* */类型的注释内移动

| 快捷键 | 效果             |
| ------ | ---------------- |
| `[/`   | 移动到注释的开始 |
| `]/`   | 移动到注释的末尾 |



### 当前行按字符移动光标

| 快键键       | 效果                                                         |
| ------------ | ------------------------------------------------------------ |
| `nfx`或`nFx` | 在当前行向前或向后移动光标到x字符处,n代表第n次出现           |
| `ntx`或`nTx` | 在当前行向前或向后移动光标到x字符的前一个字符处,n代表第n次出现.连续按tx只会停在一处,因为光标一直没超过x |
| `n;`         | 重复上次的fx,Fx,tx,Tx动作n次                                 |
| `n,`         | 反方向执行上次的fx,Fx,tx,Tx动作n次                           |

### 区块选择(Visual Block)

在普通模式下使用

| 按键   | 效果                                                         |
| ------ | ------------------------------------------------------------ |
| `v`    | 字符选择,会将光标经过的地方反白选择                          |
| `V`    | 行选择,会将光标经过的行反白选择                              |
| ctrl+v | 区块选择,可以用长方形的方式选择资料                          |
| `I`    | 在ctrl+v之后使用,在选中的区块前插入字符,按esc结束            |
| `y`    | 将反白的地方复制起来                                         |
| `d`    | 将反白的地方删除掉                                           |
| `gv`   | 将上次选中的内容重新选中,如果上次选中的内容删除,会根据上次删除的内容选择相近的内容(具体什么内容我无法用语音描述清楚) |
| `gh`   | 进入字符选择模式的替换模式,用方向键调整选中范围,按其他键就会把选中的字符替换掉并进入插入模式 |
| `gH`   | 进入行选择模式的替换模式,用方向键调整选中范围,按其他键就会把选中的字符替换掉并进入插入模式 |
| `vab`  | 如果光标在一个()中,选中()内的所有内容,包括()号,如果()内有多个次级()号,而光标不在次级()内,不会选中一级()内所有内容,比如((abc)def(ghi)),光标在e处,按vab,不会选中((abc)def(ghi)) |
| `vaB`  | 如果光标在一个{}中,选中{}内的所有内容,包括{}号,如果{}内有多个次级{}号,而光标不在次级{}内,不会选中一级{}内所有内容,比如{{abc}def{ghi}},光标在e处,按vab,不会选中{{abc}def{ghi}} |
| `vnm`  | 选择区块,n代表动的位数,默认为1,m指移动命令,可以为h,j,k,l,gg,G,0,$等 |
| `vtx`  | t代表till,x代表任意字符,选中光标所在字符到x字符之间字符,(不包括光标所在字符和x字符) |
| `vfx`  | x代表任意字符,选中光标所在字符到x字符之间字符(包括光标所在字符和x字符) |



### 搜索与替换

下面操作是在普通模式和命令行模式下进行的

| 快捷键                                 | 效果                                                         |
| -------------------------------------- | ------------------------------------------------------------ |
| `/word`                                | 向光标之下寻找一个名称为word的字符串.例如要在档案内搜寻vbird这个字符串,就输入/vbird即可！ |
| `?word`                                | 向光标之上寻找一个字符串名称为word的字符串.                 |
| `/\<word\>` | 向光标下方搜索完整的单词word而不是字符串word |
| `?\<word\>` | 向光标上方搜索完整的单词word而不是字符串word |
| `*`                                    | 普通模式下,将光标移动到某个单词上面,敲shift+8,将向下搜索此单词,按n向下查找,按N向上查找 |
| `#`                                    | 普通模式下,将光标移动到某个单词上面,敲shift+3,将向上搜索此单词,按n向上查找,按N向下查找 |
| `n`                                    | 这个n是英文按键.代表''重复前一个搜寻的动作''.举例来说,如果刚刚我们执行 /vbird去向下搜寻vbird这个字符串,则按下n后,会向下继续搜寻下一个名称为vbird的字符串.如果是执行?vbird的话,那么按下n则会向上继续搜寻名称为vbird的字符串！ |
| `N`                                    | 这个N是英文按键.与n刚好相反,为反向进行前一个搜寻动作.例如 /vbird后,按下N则表示向上搜寻vbird. |
| `gd`                                   | 跳转到光标所在字符串在函数内第一次定义的位置,非常适合看代码,跳到变量定义位置(局部变量) |
| `gD`                                   | 跳转到光标所在字符串在文件中第一次定义的位置,非常适合看代码,跳到变量定义位置(全局变量) |
| `:n1,n2s/word1/word2/g`                | n1与n2为数字.在第n1与n2行之间寻找word1这个字符串,并将该字符串取代word2！举例来说,在100到200行之间搜寻vbird并取代为VBIRD则：`:100,200s/vbird/VBIRD/g`. |
| `:s/word1/word2/g`                     | 在光标所在行寻找word1这个字符串,并替换为word2                |
| `:s/\<aaa\>/bbb/g`                     | 整词替换而不是字符串替换,把需要整词替换的字符串用<>包起来.比如"this is aaa"中的"aaa"会被替换为"bbb",而"this is newaaa"中的"aaa"不会替换为"bbb" |
| `:%s/\(aa\|bb\)/cc/g`                  | aa和bb都会被替换为cc                                         |
| `:1,$s/word1/word2/g`<br>或`:%s/word1/word2/g` | 从第一行到最后一行寻找word1字符串,并将该字符串取代为word2！ |
| `:1,$s/word1/word2/gc`                 | 从第一行到最后一行寻找word1字符串,并将该字符串取代为word2！且在取代前显示提示字符给用户确认(confirm)是否需要取代！<br />有这几个选项可以选:<br />y 替换且跳转到下一个匹配结果<br />n 不替换且跳转到下一个匹配结果<br />a 替换所有并退出交互模式<br />l 替换当前并退出交互模式<br />q 退出交互模式 |
| `:%s/^/\=line(".")/g`                  | 把行首^替换成行号,可自定义具体形式                           |
| `:%s/word1//gn`                       | 统计字符串word1在全文出现了多少次                            |

替换操作可以配合区块选择使用,选中一部分区域后按:,命令行会自动变成`:'<,'>`,这时按's',就可以对这块选中的区域进行替换操作了

搜索模式后加`\c`可以强制忽略大小写搜索,加`\C`可以强制区分大小写搜索,比如`/Linux\c`,就是忽略大小写搜索"linux"字符串

### 删除,复制与黏贴

下面操作都是在普通模式下进行的

| 快捷键      | 效果                                                         |
| ----------- | ------------------------------------------------------------ |
| `x`,`X`     | 在一行字当中,x为向后删除一个字符(相当于[del]按键),X为向前删除一个字符(相当于[backspace]退格键) |
| `nx`        | n为数字,连续向后删除n个字符.举例来说,我要连续删除10个字符,`10x` |
| `dd`        | 删除光标所在的那一整列                                       |
| `ndd`       | n为数字.删除光标所在的向下n列,例如20dd则是删除20列           |
| `dw`        | 删除一个单词,(以字母和数字组成的词,以符号或空格分割,删除过程中会移动到符号处,删除时会自动将词或符号后的空格,tab删除)如果光标不在单词开头,删除光标所在位置到单词结束处；如果是中文字符串,删除光标所在位置到中文字符串结束处 |
| `dW`        | 删除光标到光标后最近一个空格或tab处,包含空格和tab            |
| `daw`       | 删除一个单词,(以字母和数字组成的词,以符号或空格分割,删除过程中会移动到符号处,删除时会自动将词或符号后的空格,tab删除)如果光标不在单词开头,删除光标所在的整个单词；如果是中文字符串,删除整个中文字符串 |
| `diw`       | 删除一个单词,(以字母和数字组成的词,以符号或空格分割,删除过程中会移动到符号处)如果光标不在单词开头,删除光标所在的整个单词；如果是中文字符串,删除整个中文字符串 |
| `dfx`       | x代表任意字符,删除光标所在字符到x字符之间字符(包括光标所在字符和x字符) |
| `dtx`       | t代表till,x代表任意字符,删除光标所在字符到x字符之间字符,(不包括光标所在字符和x字符) |
| `d1G`,`dgg` | 删除光标所在到第一行的所有数据                               |
| `dG`        | 删除光标所在到最后一行的所有数据                             |
| `d$`,`D`    | 删除游标所在处,到该行的最后一个字符                          |
| `d0`        | 那个是数字的0,删除游标所在处,到该行的最前面一个字符          |
| `yy`        | 复制光标所在行                                               |
| `Y`         | 复制光标所在行                                               |
| `nyy`       | n为数字.复制光标所在的向下n列,例如20yy则是复制20列           |
| `yw`        | 复制一个单词,(以字母和数字组成的词,以符号或空格分割,光标如果在符号处,会将符号后下一个单词前所有字符复制)如果光标不在单词开头,复制光标所在位置到单词结束处；如果是中文字符串,复制光标所在位置到中文字符串结束处 |
| `yW`        | 复制光标到光标后最近一个空格或tab处,包含空格和tab            |
| `yaw`       | 复制一个单词及后面的空格,tab字符,(以字母和数字组成的词,以符号或空格分割,光标如果在符号处,会将符号后下一个单词前所有字符复制)如果光标不在单词开头,复制光标所在的整个单词,此时光标会移动到单词开头；如果是中文字符串,复制整个中文字符串 |
| `yiw`       | 复制一个单词,(以字母和数字组成的词,以符号或空格分割,光标如果在符号处,会将符号后下一个单词前所有字符复制)如果光标不在单词开头,复制光标所在的整个单词,此时光标会移动到单词开头；如果是中文字符串,复制整个中文字符串 |
| `ytx`       | t代表till,x代表任意字符,复制光标所在字符到x字符之间字符,(不包括光标所在字符和x字符) |
| `yfx`       | x代表任意字符,复制光标所在字符到x字符之间字符(包括光标所在字符和x字符) |
| `y1G`       | 复制游标所在列到第一列的所有数据                             |
| `yG`        | 复制游标所在列到最后一列的所有数据                           |
| `y0`        | 复制光标所在的那个字符到该行行首的所有数据                   |
| `y$`        | 复制光标所在的那个字符到该行行尾的所有数据                   |
| `np`,`nP`   | n代表需要黏贴的次数.p为将已复制的数据在光标下一行贴上,P则为贴在游标上一行！举例来说,我目前光标在第 20行,且已经复制了10行数据.则按下p后,那 10行数据会贴在原本的20行之后,亦即由21行开始贴.但如果是按下P呢？那么原本的第 20行会被推到变成30行. |

#### 其他复制行的方法

将n到m行之间数据复制到l行后面,包括n和m行

`:n,m copy l`

将n到m行之间数据移动到l行后面,包括n和m行

`:n,m move l`



### 大小写转换

#### `~`操作

一般模式下按`~`,转换光标所在字符的大小写(大写转换为小写,小写转换为大写),并将光标移动到下一个字符

#### 区块选择转换大小写

选中某个区域后,按`~`对选中的区域转换大小写,按`u`转换为小写,按`U`转换为大写

#### `g~nm`操作

`g~nm`,`gunm`或`gUnm`,按行或列转换大小写

其中:

> u代表转换为小写,U代表转换为大写
>
> n指移动的位数,默认为1
>
> m指移动命令,如果m代表光标向左或向上移动,那么光标会移动,如果m代表光标向下或向右移动,光标不会移动

例子:

`guh`:	将光标前的字母转换为小写,光标向前移动一个字符

`guj`:	将光标所在行和下面一行的字母转换为小写,光标不动

`guk`:	将光标所在行和上面一行的字母转换为小写,光标向上移动一行

`gul`:	将光标后的字母转换为小写,光标不动

以此类推,m可以使用b,e,B,w,gg,G,0,$等移动光标的操作

#### `g~tx`操作

`g~tx`,`gutx`或`gUtx`

将光标所在位置到当前行中第一个x字符间的字母转换大小写(不包括x字符)

> t代表till,直到后面的x处
>
> x代表任意字符

#### `g~fx`操作

`g~fx`,`gufx`或`gUfx`

将光标所在位置到当前行中第一个x字符间的字母转换大小写(不包括x字符)

> x代表任意字符



### 其他常用

| 快捷键 | 效果                                                         |
| ------ | ------------------------------------------------------------ |
| `J`    | 将光标所在列与下一列的数据结合成同一列                       |
| `u`    | 撤销前一个动作,即office上的ctrl+z                            |
| ctrl+r | 恢复上一个动作,即office上的ctrl+y                            |
| `.`    | 重复前一个动作的意思.如果你想要重复删除、重复贴上等等动作,按下小数点'.'就好了,前面可以加n,n为数字,代表重复执行n次 |
| ctrl+a | 如果光标在一个数字前或数字中,会让这个数字加1                 |
| ctrl+x | 如果光标在一个数字前或数字中,会让这个数字减1                 |



### 普通模式和编辑模式的切换

进入插入模式时左下角会出现“--INSERT--”或“--REPLACE--”字符

| 按键    | 效果                                                         |
| ------- | ------------------------------------------------------------ |
| `i`,`I` | 进入插入模式(Insert mode)：i为从目前光标所在处插入,I为在目前所在行的第一个非空格符处开始插入 |
| `a`,`A` | 进入插入模式(Insert mode)：a为从目前光标所在的下一个字符处开始插入,A为从光标所在行的最后一个字符处开始插入 |
| `o`,`O` | 进入插入模式(Insert mode)：这是英文字母o的大小写.o为在目前光标所在的下一行处插入新的一行；O为在目前光标所在处的上一行插入新的一行 |
| `r`,`R` | 进入替换模式(Replace mode)：r只会替换光标所在的那一个字符一次；R会一直替换光标所在的文字,直到按下ESC为止 |
| `s`     | 删除光标后一个字符并进入插入模式                             |
| `S`     | 删除当前行的所有内容并进入插入模式                           |
| `esc`   | 退出编辑模式,回到一般模式中                                  |

c命令很强大,单独说

| 按键      | 效果                                                         |
| --------- | ------------------------------------------------------------ |
| `cc`      | 删除当前行的所有内容并进入插入模式,和S一样                   |
| `cw`      | 删除一个单词并进入插入模式,(以字母和数字组成的词,以符号或空格分割,删除过程中会移动到符号处,删除时会自动将词或符号后的空格,tab删除)如果光标不在单词开头,删除光标所在位置到单词结束处；如果是中文字符串,删除光标所在位置到中文字符串结束处 |
| `cW`      | 删除光标到光标后最近一个空格或tab处,包含空格和tab,并进入插入模式 |
| `caw`     | 删除一个单词并进入插入模式,(以字母和数字组成的词,以符号或空格分割,删除过程中会移动到符号处,删除时会自动将词或符号后的空格,tab删除)如果光标不在单词开头,删除光标所在的整个单词；如果是中文字符串,删除整个中文字符串 |
| `ciw`     | 删除一个单词并进入插入模式,(以字母和数字组成的词,以符号或空格分割,删除过程中会移动到符号处)如果光标不在单词开头,删除光标所在的整个单词；如果是中文字符串,删除整个中文字符串 |
| `C`和`c$` | 删除光标所在位置到本行行尾所有字符并进入插入模式             |
| `c0`      | 删除光标所在位置到本行行首的所有字符并进入插入模式           |
| `cfx`     | x代表任意字符,删除光标所在字符到x字符之间字符并进入插入模式(包括光标所在字符和x字符) |
| `ctx`     | x代表任意字符,删除光标所在字符到x字符之间字符并进入插入模式(不包括光标所在字符和x字符) |
| `cnm`     | n指移动的位数,默认为1,m指移动命令,m可以为h,j,k,l,b,e,b,w,gg,G,0,$,但m为j,k,gg或G这种代表行的命令时,n的值会自动加1,比如c2j,会删除光标所在行加上光标所在行的下面两行,然后光标在1个空白行的行首,即删除3行多加1行空白行 |



## 指令模式命令

| 按键                             | 效果                                                         |
| -------------------------------- | ------------------------------------------------------------ |
| :n                               | 移动到n行的行首非空格,tab处                                  |
| :nd                              | 删除第n行,同时将光标移动到第n行                              |
| :w                               | 将编辑的数据写入硬盘档案中                                   |
| :w!                              | 若文件属性为『只读』时，强制写入该档案。不过，到底能不能写入，<br/>还是跟你对该档案的档案权限有关啊 |
| :q                               | 离开vi                                                       |
| :q!                              | 若曾修改过档案，又不想储存，使用!为强制离开不储存档案        |
| :wq                              | 储存后离开，若为:wq!则为强制储存后离开                       |
| ZZ                               | 这是大写的Z喔！若档案没有更动，则不储存离开，若档案已经被更动过，则储存后离开 |
| :w[filename]或:saveas [filename] | 将编辑的数据储存成另一个档案（类似另存新档）                 |
| :r[filename]                     | 在编辑的数据中，读入另一个档案的数据。亦即将『filename』这个档案内容加到游标所在行后面 |
| :r!command                       | 执行命令command，并将输出插入至光标下方                      |
| :n1,n2 w [filename]              | 将n1到n2行的内容储存成filename这个档案                       |
| :! command                       | 暂时离开vi到指令列模式下执行command的显示结果.例如『:!ls /home』即可在vi当中察看/home底下以ls输出的档案信息 |

### vi环境变更

| 按键             | 效果                                               |
| ---------------- | -------------------------------------------------- |
| :set nu          | 显示行号，设定之后，会在每一行的前缀显示该行的行号 |
| :set nonu        | 与set nu 相反，为取消行号                          |
| :set ff          | 显示文本是unix还是dos格式                          |
| :set ff=unix/dos | 设置文本格式                                       |
| :sh              | 从vim进入之前的bash中，exit或者ctrl+d重新回到vim中 |
| :set mouse=a     | 可以用鼠标控制vim界面                              |

更多vi环境选项请看后面的环境设定与记录：~/.vimrc,~/.viminfo



## 多文件编辑和窗口

| 按键                | 效果                                                         |
| ------------------- | ------------------------------------------------------------ |
| :files,:ls,:buffers | 列出目前这个vim的开启的所有档案，%a表示文件在当前活动窗口，#表示上一个活动窗口 |

### vim直接打开多个文件

```shell
vim file1 file2...
```

| 按键      | 效果           |
| --------- | -------------- |
| :n，:next | 编辑下一个档案 |
| :N，:prev | 编辑上一个档案 |

### vim另一种打开新文件的方式

如果设置了自动保存:set autowrite,使用这种方式,:bn和:bp切换文件时会自动写入当前文件的修改

| 按键                         | 效果                                                         |
| ---------------------------- | ------------------------------------------------------------ |
| :e [filename]或:o [filename] | 打开另一个文件,注意,使用e打开另一个文件前需要将当前文件的修改写入,或者执行:e!,打开另一个文件后,执行:q退出时,会将多个打开的文件都退出.o代表open,建议用e,e可以按tab补全 |
| :bn                          | bnext,这种方式打开多个文件时切换到下一个文件                 |
| :bp                          | bprevious,这种方式打开多个文件时切换到上一个文件             |

### vim多标签(tab page)打开多个文件

```shell
vim -p file1 file2...
```

| 按键                                  | 效果                                                         |
| ------------------------------------- | ------------------------------------------------------------ |
| ctrl+pgdn                             | 切到下一个标签,如果在终端打开了多个标签(ctrl+shift+t),这会和终端的标签切换冲突 |
| ctrl+pgup                             | 切到上一个标签,如果在终端打开了多个标签(ctrl+shift+t),这会和终端的标签切换冲突 |
| :tabnew [filename]                    | 新建一个标签打开一个文件                                     |
| :tabedit [filename]或:tabe [filename] | 新建一个标签打开一个文件                                     |
| :tabc                                 | 关闭当前标签                                                 |
| :tabo                                 | 关闭所有其他的标签                                           |
| :tabp或在一般模式按gT                 | 切到上一个标签                                               |
| :tabn或在一般模式按gt                 | 切到下一个标签                                               |
| :tabs                                 | 查看所有tab的列表,>表示当前所在的标签                        |
| ngt                                   | 切换到第n个标签                                              |

可以隐藏窗口最上方的标签栏

`:set showtabline=0`

### vim多窗口打开文件

水平多窗口打开

```shell
vim -o file1 file2...
```

垂直多窗口打开

```shell
vim -O file1 file2...
```

| 按键                                | 效果                                                         |
| ----------------------------------- | ------------------------------------------------------------ |
| :sp [filename]                      | 在屏幕下方开启一个新窗口，水平分割屏幕，如果有加filename，表示在新窗口开启一个新档案，否则表示两个窗口为同一个档案内容(同步显示) |
| :vsp [filename]或:vsplit [filename] | 在屏幕左方开启一个新窗口，垂直分割屏幕，如果有加filename，表示在新窗口开启一个新档案，否则表示两个窗口为同一个档案内容(同步显示) |
| [ctrl]+w+j [ctrl]+w+↓                | 按键的按法是：先按下[ctrl]不放，再按下w后放开所有的按键，然后再按下j(或向下箭头键)，则光标可移动到下方的窗口 |
| [ctrl]+w+k [ctrl]+w+↑                | 同上，不过光标移动到上面的窗口                               |
| [ctrl]+w+q                          | 其实就是:q结束离开啦！举例来说，如果我想要结束下方的窗口，那么利用[ctrl]+w+↓移动到下方窗口后，按下:q即可离开，也可以按下 [ctrl]+w+q啊 |
| [ctrl]+w+w | 在各窗口之间切换 |
| [ctrl]+w+_和[ctrl]+w+\| | 横屏最大化尺寸和竖屏最大化尺寸 |
| [ctrl]+w+= | 恢复成两个窗口相等的尺寸 |
| [ctrl]+w++和[ctrl]+w+- | 水平分割增加和减小尺寸 |
| [ctrl]+w+>和[ctrl]+w+< | 垂直分割向右和向左移动窗口 |
| :nwinc +/- | 水平分割把当前窗口高度增加,减少n个字符 |
| :nwinc >/< | 垂直分割把当前窗口宽度增加,减少n个字符 |

### preview窗口

preview窗口指在当前屏幕新建一个光标不会自动跳过去的窗口

水平新建preview窗口打开xxx.h文件

`:pedit xxxx.h`

在c语言的当前文件中和当前文件包含的文件中查找字段名,并在水平preview窗口中打开

`:psearch 字段名`

关闭preview窗口

`:pclose`或者`<ctrl-w>+c`

## 环境设定与记录：~/.vimrc,~/.viminfo

这里只给出查看已设置的选项结果,各选项请看我的.vimrc文件

| 按键                  | 效果                                                         |
| --------------------- | ------------------------------------------------------------ |
| :set all              | 显示目前所有的环境参数设定值                                 |
| :set                  | 显示与系统默认值不同的设定参数，一般来说就是你有自行变动过的设定参数啦 |
| :syntax on :syntax off | 是否依据程序相关语法显示不同颜色？举例来说，在编辑一个纯文本档时，如果开头是以 # 开始，那么该行就会变成蓝色。如果你懂得写程序，那么这个 :syntax on 还会主动的帮你除错呢！但是，如果你仅是编写纯文本档案，要避免颜色对你的屏幕产生的干扰，则可以取消这个设定 |



## vim一些有用操作

### vim+cope+make的使用

1.进命令行模式执行:

 :cope

执行完成后,在vim的编辑界面下方出现一个新窗口

2.在命令行模式执行:

:set mouse=a

让vim支持鼠标选中

3.在命令行模式执行

:make

make的打印信息将会出现在新窗口中

### vim加密文件

1.vim编辑好文件后,进入命令行模式:

:X

2.输入两次密码

3.保存退出

4.再次打开时需要输入正确密码才可查看文件,否则文件显示乱码

5.必须正确输入密码后才能删除密码,否则在乱码状态下删除密码后,文件将永久乱码!删除密码方法:

:set key=

6.保存退出

### vim中保存一个没有权限的文件

有的时候我们对一个文件编辑了很多,保存的时候发现没有写权限,我们可以这样

:w !sudo tee > /dev/null %

### vim历史命令

q:

搜索历史命令

q/

### 头文件的跳转

一般模式下将光标移到头文件上,按gf,即可打开头文件,按ctrl+o返回

一般模式下将光标移到头文件上,按ctrl+w,再按f,即可垂直在上面开一个窗口打开头文件

一般模式下将光标移到头文件上,按ctrl+w,再按gf,即可新开一个标签打开头文件

如果提示"E447: Can't find file "mach/s5p6818_irq.h" in path",需要配置path,即头文件所在的路径:

:set path=xxxx

ubuntu18.04下的vim 8.0的默认path为path=.,/usr/include,,



### 快速选中,修改,删除,复制引号,括号内的内容

普通模式光标进入成对的符号中,输入下面的指令

ci',ci”,ci(,ci[,ci{,ci<	删除这些配对标点符号中的文本内容并进入插入模式,不包括标点符号

di',di”,di(,di[,di{,di<	删除这些配对标点符号中的文本内容,不包括标点符号

yi',yi”,yi(,yi[,yi{,yi<	复制这些配对标点符号中的文本内容,不包括标点符号

vi',vi”,vi(,vi[,vi{,vi<	选中这些配对标点符号中的文本内容,不包括标点符号

以上(都可以用b代替,{都可以用B代替

如果上面所做的操作都希望包括标点符号,把i换成a

### 录制宏

宏可以方便我们做很多重复的操作

使用方法:

在一般模式下按qx,x为录制的宏名称,可以26个字母或10个数字之一

这时就进入录制宏了

后面的所有操作都会记录为宏操作

直到在一般模式按q结束录制

播放宏:

按n@x

n为宏需要执行的次数,默认为1

x为录制的宏名称



## 其他资料

vim命令大全：ctolib.com/cheatsheets-Vim-command.html
